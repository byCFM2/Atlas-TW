-- Naxxramas.lua - Данные предметов из Наксрамаса
-- Модульная структура данных для Atlas-TW

local _G = getfenv()
AtlasTW = _G.AtlasTW or {}
local L = AtlasTW.Local
local BZ = AceLibrary("Babble-Zone-2.2a")
local BB = AceLibrary("Babble-Boss-2.2a")
local BF = AceLibrary("Babble-Faction-2.2a")
AtlasTW.InstanceData = AtlasTW.InstanceData or {}

-- Данные Наксрамаса
AtlasTW.InstanceData.Naxxramas = {
    Name = BZ["Naxxramas"],
    Location = BZ["Eastern Plaguelands"],
    Level = 60,
    Acronym = "Naxx",
    Attunement = true,
    MaxPlayers = 40,
    DamageType = L["All"],
    Entrances = {
        { letter = "A"..") " .. L["Entrance"] }
    },
    Reputation = {
           { name = BF["Argent Dawn"], loot = "ArgentDawn" }
    },
    Bosses = {
        {
            name = L["Archmage Tarsis Kir-Moldir"],
            color = "|cff9d9d9d",
        },
        {
            name = L["Mr. Bigglesworth"] .. " (" .. L["Wanders"] .. ")",
            color = "|cff9d9d9d",
        },
        {
            name = L["Abomination Wing"],
        },
        {
            id = "Patchwerk",
            prefix = "1)",
            name = BB["Patchwerk"],
            defaults = { dropRate = 20 },
            loot = {
                {id=22726, dropRate=20, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22368, dropRate=33, container={22515,47220,22499,47100,22507,47298}},
                {id=22361, dropRate=33, container={22429,47043,47052,22439,22467,47163,47172,22491,47373,47382}},
                {id=22354, dropRate=33, container={22419,47262,22479}},
                {},
                {id=22960},
                {id=22961},
                {},
                {id=22820},
                {id=22818},
                {id=22815},
            }
        },
        {
            id = "Grobbulus",
            prefix = "2)",
            name = BB["Grobbulus"],
            defaults = { dropRate = 20 },
            loot = {
                {id=22726, dropRate=20, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22368, dropRate=33, container={22515,47220,22499,47100,22507,47298}},
                {id=22361, dropRate=33, container={22429,47043,47052,22439,22467,47163,47172,22491,47373,47382}},
                {id=22354, dropRate=33, container={22419,47262,22479}},
                {},
                {id=22968},
                {id=22967},
                {},
                {id=22810},
                {id=22803},
                {id=22988},
            }
        },
        {
            id = "Gluth",
            prefix = "3)",
            name = BB["Gluth"],
            defaults = { dropRate = 20 },
            loot = {
                {id=22726, dropRate=30, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22983},
                {id=22981},
                {id=22994},
                {},
                {id=23075},
                {id=22813},
                {},
                {},
                {},
                {},
                {},
                {},
                {id=22368, dropRate=33, container={22515,47220,22499,47100,22507,47298}},
                {id=22369, dropRate=8, container={22519,47222,22503,47102,22511}},
                {id=22370, dropRate=8, container={22518,47224,22502,47104,22510}},
                {id=22372, dropRate=8, container={22516,47226,22500,47106,22508,47304}},
                {id=22361, dropRate=33, container={22429,47043,47052,22439,22467,47163,47172,22491,47373,47382}},
                {id=22362, dropRate=8, container={22424,47045,47054,22443,22471,47165,47174,22495,47375,47384}},
                {id=22363, dropRate=8, container={22431,47047,47056,22442,22470,47167,47176,22494,47377,47386}},
                {id=22365, dropRate=8, container={22430,47049,47058,22440,22468,47169,47178,22492,47379,47388}},
                {id=22354, dropRate=33, container={22419,47262,22479}},
                {id=22355, dropRate=8, container={22423,47264,22483}},
                {id=22356, dropRate=8, container={22422,47266,22482}},
                {id=22358, dropRate=8, container={22420,47268,22480}},
            }
        },
        {
            id = "Thaddius",
            prefix = "4)",
            name = BB["Thaddius"],
            defaults = { dropRate = 20 },
            loot = {
                {id=22726, dropRate=30, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22367, dropRate=33, container={22514,47219,22498,47099,22506,47297}},
                {id=22360, dropRate=33, container={22428,47042,47051,22438,22466,47162,47171,22490,47372,47381}},
                {id=22353, dropRate=33, container={22418,47261,22478}},
                {},
                {id=23000},
                {id=23070},
                {},
                {id=23001},
                {},
                {id=22808},
                {id=22801},
            }
        },
        {
            name = L["Spider Wing"],
            color = "|cffFFA500",
        },
        {
            id = "AnubRekhan",
            prefix = "1)",
            name = BB["Anub'Rekhan"],
            color = "|cffFFA500",
            defaults = { dropRate = 20 },
            loot = {
                {id=22726, dropRate=20, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22369, dropRate=33, container={22519,47222,22503,47102,22511}},
                {id=22362, dropRate=33, container={22424,47045,47054,22443,22471,47165,47174,22495,47375,47384}},
                {id=22355, dropRate=33, container={22423,47264,22483}},
                {},
                {id=22935},
                {id=22938},
                {id=22936},
                {},
                {id=22939},
                {},
                {id=22937},
            }
        },
        {
            id = "GrandWidowFaerlina",
            prefix = "2)",
            name = BB["Grand Widow Faerlina"],
            color = "|cffFFA500",
            defaults = { dropRate = 20 },
            loot = {
                {id=22726, dropRate=30, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22369, dropRate=33, container={22519,47222,22503,47102,22511}},
                {id=22362, dropRate=33, container={22424,47045,47054,22443,22471,47165,47174,22495,47375,47384}},
                {id=22355, dropRate=33, container={22423,47264,22483}},
                {},
                {id=22943},
                {id=22941},
                {id=22940},
                {},
                {id=22942},
                {id=22806},
            }
        },
        {
            id = "Maexxna",
            prefix = "3)",
            name = BB["Maexxna"],
            color = "|cffFFA500",
            defaults = { dropRate = 20 },
            loot = {
                {id=22726, dropRate=30, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22371, dropRate=33, container={22517,47223,22501,47103,22509,47301}},
                {id=22364, dropRate=33, container={22426,47046,47055,22441,22469,47166,47175,22493,47376,47385}},
                {id=22357, dropRate=33, container={22421,47265,22481}},
                {},
                {id=22947},
                {id=23220},
                {id=22954},
                {},
                {id=22807},
                {id=22804},
            }
        },
        {
            name = L["Plague Wing"],
            color = "|cff9370DB",
        },
        {
            id = "NoththePlaguebringer",
            prefix = "1)",
            name = BB["Noth the Plaguebringer"],
            color = "|cff9370DB",
            defaults = { dropRate = 14 },
            loot = {
                {id=22726, dropRate=30, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22370, dropRate=8, container={22518,47224,22502,47104,22510}},
                {id=22363, dropRate=8, container={22431,47047,47056,22442,22470,47167,47176,22494,47377,47386}},
                {id=22356, dropRate=8, container={22422,47266,22482}},
                {},
                {id=23030},
                {id=23031},
                {id=23028},
                {id=23029},
                {id=23006},
                {id=23005},
                {},
                {id=22816},
            }
        },
        {
            id = "HeigantheUnclean",
            prefix = "2)",
            name = BB["Heigan the Unclean"],
            color = "|cff9370DB",
            defaults = { dropRate = 20 },
            loot = {
                {id=22726, dropRate=30, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22370, dropRate=8, container={22518,47224,22502,47104,22510}},
                {id=22363, dropRate=8, container={22431,47047,47056,22442,22470,47167,47176,22494,47377,47386}},
                {id=22356, dropRate=8, container={22422,47266,22482}},
                {},
                {id=23035},
                {id=23033},
                {id=23019},
                {id=23036},
                {id=23068},
            }
        },
        {
            id = "Loatheb",
            prefix = "3)",
            name = BB["Loatheb"],
            color = "|cff9370DB",
            defaults = { dropRate = 20 },
            loot = {
                {id=22726, dropRate=30, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22366, dropRate=33, container={22513,47225,22497,47105,22505,47303}},
                {id=22359, dropRate=33, container={22427,47048,47057,22437,22465,47168,47177,22489,47378,47387}},
                {id=22352, dropRate=33, container={22417,47267,22477}},
                {},
                {id=23038},
                {id=23037},
                {id=23042},
                {},
                {id=23039},
                {id=22800},
            }
        },
        {
            name = L["Deathknight Wing"],
            color = "|cffff0000",
        },
        {
            id = "InstructorRazuvious",
            prefix = "1)",
            name = BB["Instructor Razuvious"],
            color = "|cffff0000",
            defaults = { dropRate = 17 },
            loot = {
                {id=22726, dropRate=30, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22372, dropRate=33, container={22516,47226,22500,47106,22508,47304}},
                {id=22365, dropRate=33, container={22430,47049,47058,22440,22468,47169,47178,22492,47379,47388}},
                {id=22358, dropRate=33, container={22420,47268,22480}},
                {},
                {id=23017},
                {id=23219},
                {id=23018},
                {id=23004},
                {},
                {id=23009},
                {id=23014},
            }
        },
        {
            id = "GothiktheHarvester",
            prefix = "2)",
            name = BB["Gothik the Harvester"],
            color = "|cffff0000",
            defaults = { dropRate = 20 },
            loot = {
                {id=22726, dropRate=30, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22372, dropRate=33, container={22516,47226,22500,47106,22508,47304}},
                {id=22365, dropRate=33, container={22430,47049,47058,22440,22468,47169,47178,22492,47379,47388}},
                {id=22358, dropRate=33, container={22420,47268,22480}},
                {},
                {id=23032},
                {id=23020},
                {id=23023},
                {id=23021},
                {id=23073},
            }
        },
        {
            id = "TheFourHorsemen",
            prefix = "3)",
            name = BB["The Four Horsemen"],
            color = "|cffff0000",
            defaults = { dropRate = 17 },
            loot = {
                {id=22726, dropRate=30, container={22631,22589,22630,22632}},
                {id=22727},
                {},
                {id=22351, dropRate=33, container={22512,47221,22496,47101,22504,47299}},
                {id=22350, dropRate=33, container={22425,47044,47053,22436,22464,47164,47173,22488,47374,47383}},
                {id=22349, dropRate=33, container={22416,47263,22476}},
                {},
                {id=23071},
                {id=23025},
                {id=23027},
                {},
                {id=22811},
                {id=22809},
                {id=22691},
            }
        },
        { name = BB["Thane Korth'azz"], color = "|cff9d9d9d"},
        { name = BB["Lady Blaumeux"], color = "|cff9d9d9d"},
        { name = BB["Highlord Mograine"], color = "|cff9d9d9d"},
        { name = BB["Sir Zeliek"], color = "|cff9d9d9d"},
        {
            id = "Omarion",
            prefix = "1')",
            name = BB["Master Craftsman Omarion"],
            color = "|cffff0000",
            loot = {
                {id=22719, dropRate=100},
            }
        },
        {
            prefix = "2')",
            name = L["Icebellow Anvil"],
            color = "|cffff0000",
        },
        { name = L["Frostwyrm Lair"], color = "|cffFFD700"},
        {
            id = "Sapphiron",
            prefix = "1)",
            name = BB["Sapphiron"],
            color = "|cffFFD700",
            defaults = { dropRate = 10 },
            loot = {
                {id=23050},
                {id=23045},
                {id=23040},
                {id=23047},
                {id=23041},
                {id=23046},
                {},
                {id=23049},
                {id=23048},
                {id=23043},
                {id=23242},
                {},
                {},
                {},
                {},
                {id=23549, dropRate=50},
                {id=23548, dropRate=50},
                {id=23545, dropRate=50},
                {id=23547, dropRate=50},
            }
        },
        {
            id = "KelThuzard",
            prefix = "2)",
            name = BB["Kel'Thuzad"],
            color = "|cffFFD700",
            defaults = { dropRate = 9 },
            loot = {
                {id=23057},
                {id=23053},
                {},
                {id=22812},
                {id=22821},
                {id=22819},
                {id=22802},
                {id=23056},
                {id=23054},
                {id=23577},
                {id=22798},
                {id=22799},
                {},
                {},
                {id=22520, dropRate=100, container={23207,23206}},
                {id=55581, dropRate=33, container={23059,47269,23060}},
                {id=55582, dropRate=33, container={23061,47227,23062,47107,23063,47305}},
                {id=55583, dropRate=33, container={23066,47050,47059,23067,23065,47170,47179,23064,47380,47389}},
                {},
                {id=81283, dropRate=100},
                {},
                {id=22733, dropRate=100, container={22631,22589,22630,22632}},
                {id=36666, dropRate=1},
            }
        },
        {
            id = "NAXTrash",
            name = L["Trash Mobs"],
            defaults = { dropRate = 1 },
            loot = {
                {id=23664},
                {id=23667},
                {id=23069, dropRate=7},
                {id=23226, dropRate=2},
                {id=23663},
                {id=23666},
                {id=23665, dropRate=2},
                {id=23668, dropRate=2},
                {},
                {id=23237, dropRate=3},
                {},
                {id=23238},
                {id=23044, dropRate=2},
                {id=23221, dropRate=3},
                {},
                {id=22376, disc=L["Quest Item"], dropRate=35},
                {id=22373, disc=L["Quest Item"], dropRate=26},
                {id=22374, disc=L["Quest Item"], dropRate=27},
            }
        },
        { name = L["Tier 3 Sets"], items = "AtlasLootT3SetMenu" },
    }
}

-- Инициализация предметов для всех боссов
for _, bossData in ipairs(AtlasTW.InstanceData.Naxxramas.Bosses) do
    bossData.items = bossData.items or AtlasTW.CreateItemsFromLootTable(bossData)
    bossData.loot = nil -- Очищаем временные данные
end